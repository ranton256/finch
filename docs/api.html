<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Reference - Finch Graphics Library</title>
    <link rel="stylesheet" href="style.css">
    <style>
        .api-section {
            margin-top: 2rem;
            padding-top: 1rem;
            border-top: 1px solid var(--border-color);
        }
        .function-sig {
            background: #f0f0f0;
            padding: 0.5rem 1rem;
            border-left: 3px solid var(--accent-color);
            margin: 1rem 0;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
        }
        .param-list {
            margin-left: 2rem;
        }
        .param-list dt {
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-weight: 600;
            margin-top: 0.5rem;
        }
        .param-list dd {
            margin-left: 1.5rem;
            margin-bottom: 0.5rem;
        }
        nav.api-nav {
            position: sticky;
            top: 0;
            background: white;
            z-index: 100;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .quick-ref {
            columns: 2;
            column-gap: 2rem;
        }
        @media (max-width: 768px) {
            .quick-ref {
                columns: 1;
            }
        }
    </style>
</head>
<body>
    <header>
        <h1>Finch API Reference</h1>
        <p>Complete documentation of all functions, types, and constants</p>
    </header>

    <nav class="api-nav">
        <ul>
            <li><a href="index.html">Home</a></li>
            <li><a href="tutorial.html">Tutorial</a></li>
            <li><a href="api.html">API Reference</a></li>
            <li><a href="examples.html">Examples</a></li>
            <li><a href="https://github.com/ranton256/finch">GitHub</a></li>
        </ul>
    </nav>

    <main>
        <section>
            <h2>Quick Reference</h2>
            <div class="quick-ref">
                <ul>
                    <li><a href="#fundamentals">Fundamentals</a></li>
                    <li><a href="#lifecycle">Application Lifecycle</a></li>
                    <li><a href="#buffers">Buffer Management</a></li>
                    <li><a href="#colors">Color Functions</a></li>
                    <li><a href="#drawing">Basic Drawing</a></li>
                    <li><a href="#lines">Line Drawing</a></li>
                    <li><a href="#rectangles">Rectangles</a></li>
                    <li><a href="#circles">Circles</a></li>
                    <li><a href="#text">Text Rendering</a></li>
                    <li><a href="#blitting">Blitting</a></li>
                    <li><a href="#utility">Utility Functions</a></li>
                    <li><a href="#input">Input Events</a></li>
                </ul>
            </div>
        </section>

        <section id="fundamentals" class="api-section">
            <h2>Fundamentals</h2>

            <h3>Coordinate System</h3>
            <p>Origin (0,0) is at the top-left corner. X increases right, Y increases downward.</p>

            <h3>Pixel Format</h3>
            <p>32-bit RGBA: <code>0xAARRGGBB</code></p>
            <ul>
                <li><strong>AA</strong> = Alpha (0=transparent, 255=opaque)</li>
                <li><strong>RR</strong> = Red (0-255)</li>
                <li><strong>GG</strong> = Green (0-255)</li>
                <li><strong>BB</strong> = Blue (0-255)</li>
            </ul>

            <h3>Core Types</h3>
            <div class="function-sig">typedef uint32_t Pixel;</div>
            <p>32-bit RGBA pixel value.</p>

            <div class="function-sig">typedef struct {<br>
&nbsp;&nbsp;&nbsp;&nbsp;uint8_t red, green, blue;<br>
} RGBColor24;</div>
            <p>24-bit RGB color (no alpha channel).</p>

            <div class="function-sig">typedef struct {<br>
&nbsp;&nbsp;&nbsp;&nbsp;Pixel *ptr;<br>
&nbsp;&nbsp;&nbsp;&nbsp;uint32_t width, height;<br>
&nbsp;&nbsp;&nbsp;&nbsp;uint32_t rowPixels;<br>
&nbsp;&nbsp;&nbsp;&nbsp;LSBool ownsPtr;<br>
} GraphicsBuffer;</div>
            <p>Graphics buffer wrapping pixel array with metadata.</p>

            <h3>Color Constants</h3>
            <pre><code>COLOR_WHITE       0xFFFFFFFF
COLOR_BLACK       0xFF000000
COLOR_RED         0xFFFF0000
COLOR_GREEN       0xFF00FF00
COLOR_BLUE        0xFF0000FF
COLOR_YELLOW      0xFFFFFF00
COLOR_CYAN        0xFF00FFFF
COLOR_MAGENTA     0xFFFF00FF
COLOR_GRAY        0xFF808080
COLOR_DARK_GRAY   0xFF404040
COLOR_LIGHT_GRAY  0xFFC0C0C0</code></pre>
        </section>

        <section id="lifecycle" class="api-section">
            <h2>Application Lifecycle</h2>
            <p>Finch uses a callback-based architecture. Implement these functions:</p>

            <div class="function-sig">bool FinchMain(int argc, const char* argv[], void** userData)</div>
            <p>Entry point. Call <code>FinchStartGraphics()</code> to begin. Set <code>*userData</code> to pass data to other callbacks.</p>

            <div class="function-sig">bool FinchInit(int width, int height, void* userData)</div>
            <p>Called once after window creation. Return true to continue, false to abort.</p>

            <div class="function-sig">void FinchRenderProc(int width, int height, uint32_t* pixels, void* userData)</div>
            <p>Called every frame to draw. <code>pixels</code> is the screen buffer (owned by SDL2). Wrap it with <code>NewGraphBuffer()</code> for drawing.</p>

            <div class="function-sig">void FinchUpdate(void* userData, double elapsedTicks)</div>
            <p>Called every frame for game logic. <code>elapsedTicks</code> is milliseconds since last frame.</p>

            <div class="function-sig">void FinchHandleEvent(InputEvent* event, void* userData)</div>
            <p>Called for each keyboard/mouse event.</p>

            <div class="function-sig">bool FinchDone(void* userData)</div>
            <p>Called every frame. Return true to quit the program.</p>

            <div class="function-sig">void FinchCleanup(void* userData)</div>
            <p>Called once before exit. Clean up resources.</p>
        </section>

        <section id="buffers" class="api-section">
            <h2>Buffer Management</h2>

            <div class="function-sig">GraphicsBuffer* NewGraphBuffer(Pixel* ptr, int width, int height, int rowPixels, size_t allocBytes)</div>
            <p>Create a graphics buffer.</p>
            <dl class="param-list">
                <dt>ptr</dt>
                <dd>Pixel array (or NULL to allocate new)</dd>
                <dt>width, height</dt>
                <dd>Dimensions in pixels</dd>
                <dt>rowPixels</dt>
                <dd>Stride (pixels per row, usually = width)</dd>
                <dt>allocBytes</dt>
                <dd>If ptr is NULL, allocate this many bytes</dd>
            </dl>
            <p><strong>Returns:</strong> New buffer, or NULL on failure.</p>

            <div class="function-sig">void DeleteGraphBuffer(GraphicsBuffer* buffer)</div>
            <p>Free a graphics buffer. Only frees pixel data if buffer owns it.</p>
        </section>

        <section id="colors" class="api-section">
            <h2>Color Functions</h2>

            <div class="function-sig">Pixel LSRGBA(uint8_t r, uint8_t g, uint8_t b, uint8_t a)</div>
            <p>Create pixel from RGBA components.</p>

            <div class="function-sig">Pixel MakeColor(uint8_t r, uint8_t g, uint8_t b)</div>
            <p>Create opaque pixel from RGB components (alpha = 255).</p>

            <div class="function-sig">Pixel MakeColorWithAlpha(uint8_t r, uint8_t g, uint8_t b, uint8_t a)</div>
            <p>Create pixel from RGBA components with custom alpha.</p>

            <div class="function-sig">Pixel AsPixel(RGBColor24 rgb)</div>
            <p>Convert RGBColor24 to opaque Pixel.</p>

            <div class="function-sig">void PixelComponents(Pixel p, uint8_t* r, uint8_t* g, uint8_t* b)</div>
            <p>Extract RGB components from pixel. Alpha is ignored.</p>
        </section>

        <section id="drawing" class="api-section">
            <h2>Basic Drawing</h2>

            <div class="function-sig">void ClearBuffer(GraphicsBuffer* buffer, Pixel color)</div>
            <p>Fill entire buffer with color.</p>

            <div class="function-sig">void PutPixel(GraphicsBuffer* buffer, Pixel color, int32_t x, int32_t y)</div>
            <p>Draw single pixel. Clipped to buffer bounds.</p>

            <div class="function-sig">Pixel GetPixel(GraphicsBuffer* buffer, int32_t x, int32_t y)</div>
            <p>Read pixel color. Returns 0 if out of bounds.</p>
        </section>

        <section id="lines" class="api-section">
            <h2>Line Drawing</h2>

            <div class="function-sig">void DrawLine(GraphicsBuffer* buffer, Pixel color, int32_t x1, int32_t y1, int32_t x2, int32_t y2)</div>
            <p>Draw line using Bresenham's algorithm. Opaque (ignores alpha).</p>

            <div class="function-sig">void DrawLineComposite(GraphicsBuffer* buffer, Pixel color, int32_t x1, int32_t y1, int32_t x2, int32_t y2)</div>
            <p>Draw line with alpha blending support.</p>

            <div class="function-sig">void DrawHorzLine(GraphicsBuffer* buffer, Pixel color, int32_t x1, int32_t x2, int32_t y)</div>
            <p>Draw horizontal line with alpha compositing.</p>

            <div class="function-sig">void DrawVertLine(GraphicsBuffer* buffer, Pixel color, int32_t x, int32_t y1, int32_t y2)</div>
            <p>Draw vertical line with alpha compositing.</p>
        </section>

        <section id="rectangles" class="api-section">
            <h2>Rectangle Drawing</h2>

            <div class="function-sig">void DrawRect(GraphicsBuffer* buffer, Pixel color, int32_t left, int32_t top, int32_t right, int32_t bottom)</div>
            <p>Draw rectangle outline.</p>

            <div class="function-sig">void FillRectOpaque(GraphicsBuffer* buffer, Pixel color, int32_t left, int32_t top, int32_t right, int32_t bottom)</div>
            <p>Draw filled rectangle (ignores alpha, always opaque).</p>
        </section>

        <section id="circles" class="api-section">
            <h2>Circle Drawing</h2>

            <div class="function-sig">void DrawCircle(GraphicsBuffer* buffer, Pixel color, int32_t cx, int32_t cy, int32_t radius)</div>
            <p>Draw circle outline using midpoint algorithm.</p>

            <div class="function-sig">void FillCircle(GraphicsBuffer* buffer, Pixel color, int32_t cx, int32_t cy, int32_t radius)</div>
            <p>Draw filled circle.</p>
        </section>

        <section id="text" class="api-section">
            <h2>Text Rendering</h2>
            <p>Uses built-in Press Start 2P font (8x8 pixel arcade style).</p>

            <div class="function-sig">void DrawChar(GraphicsBuffer* buffer, Pixel color, int32_t x, int32_t y, char c)</div>
            <p>Draw single character at position.</p>

            <div class="function-sig">void DrawText(GraphicsBuffer* buffer, Pixel color, int32_t x, int32_t y, const char* text)</div>
            <p>Draw text string. Position is top-left of first character.</p>

            <div class="function-sig">void DrawTextCentered(GraphicsBuffer* buffer, Pixel color, int32_t cx, int32_t cy, const char* text)</div>
            <p>Draw text centered at position.</p>

            <div class="function-sig">int32_t GetTextWidth(const char* text)</div>
            <p>Calculate pixel width of text string.</p>

            <div class="function-sig">int32_t GetTextHeight(void)</div>
            <p>Get font height in pixels (always 8).</p>

            <h3>Font Constants</h3>
            <pre><code>FONT_CHAR_WIDTH   8    // Character width in pixels
FONT_CHAR_HEIGHT  8    // Character height in pixels
FONT_FIRST_CHAR   32   // First supported character (space)
FONT_LAST_CHAR    126  // Last supported character (~)</code></pre>
        </section>

        <section id="blitting" class="api-section">
            <h2>Blitting</h2>

            <div class="function-sig">void BlitGraphBuffer(GraphicsBuffer* src, GraphicsBuffer* dst, int32_t dstX, int32_t dstY)</div>
            <p>Copy source buffer to destination. Opaque (ignores alpha).</p>

            <div class="function-sig">void BlitGraphBufferComposite(GraphicsBuffer* src, GraphicsBuffer* dst, int32_t dstX, int32_t dstY)</div>
            <p>Copy source buffer to destination with alpha blending.</p>
        </section>

        <section id="utility" class="api-section">
            <h2>Utility Functions</h2>

            <div class="function-sig">int32_t LSMin(int32_t a, int32_t b)</div>
            <p>Return minimum of two values.</p>

            <div class="function-sig">int32_t LSMax(int32_t a, int32_t b)</div>
            <p>Return maximum of two values.</p>

            <div class="function-sig">LSBool LSPointInRect(int32_t x, int32_t y, const LSRect* rect)</div>
            <p>Test if point is inside rectangle.</p>

            <div class="function-sig">LSBool IntersectRects(const LSRect* r1, const LSRect* r2, LSRect* outIntersection)</div>
            <p>Calculate intersection of two rectangles. Returns false if no overlap.</p>
        </section>

        <section id="input" class="api-section">
            <h2>Input Events</h2>

            <h3>Event Types</h3>
            <pre><code>typedef enum {
    kInputEventType_None,
    kInputEventType_KeyDown,
    kInputEventType_KeyUp,
    kInputEventType_MouseButtonDown,
    kInputEventType_MouseButtonUp,
    kInputEventType_MouseMove,
    kInputEventType_Quit
} InputEventType;</code></pre>

            <h3>Input Event Structure</h3>
            <div class="function-sig">typedef struct {<br>
&nbsp;&nbsp;&nbsp;&nbsp;InputEventType eventType;<br>
&nbsp;&nbsp;&nbsp;&nbsp;int32_t keyCode;<br>
&nbsp;&nbsp;&nbsp;&nbsp;int32_t x, y;<br>
&nbsp;&nbsp;&nbsp;&nbsp;int32_t button;<br>
} InputEvent;</div>

            <dl class="param-list">
                <dt>eventType</dt>
                <dd>Type of input event (keyboard, mouse, quit)</dd>
                <dt>keyCode</dt>
                <dd>For KeyDown/KeyUp: ASCII code ('a', 'A', 27 for ESC, etc.)</dd>
                <dt>x, y</dt>
                <dd>For mouse events: cursor position in window coordinates</dd>
                <dt>button</dt>
                <dd>For mouse button events: 1=left, 2=middle, 3=right</dd>
            </dl>

            <h3>Example Usage</h3>
            <pre><code>void FinchHandleEvent(InputEvent* event, void* userData) {
    if (event->eventType == kInputEventType_KeyDown) {
        if (event->keyCode == 'q' || event->keyCode == 27) {
            gDone = true;  // Quit on Q or ESC
        }
    }

    if (event->eventType == kInputEventType_MouseButtonDown) {
        if (event->button == 1) {
            // Left mouse button clicked at (event->x, event->y)
        }
    }

    if (event->eventType == kInputEventType_Quit) {
        gDone = true;  // Window close button
    }
}</code></pre>
        </section>

        <section class="api-section">
            <h2>Important Notes</h2>
            <ul>
                <li><strong>Screen Buffer Ownership:</strong> In <code>FinchRenderProc()</code>, the <code>pixels</code> parameter is owned by SDL2. Create a wrapper with <code>NewGraphBuffer(pixels, width, height, width, 0)</code> and delete only the wrapper, not the pixels.</li>
                <li><strong>Alpha vs Opaque:</strong> Functions ending in "Opaque" or named "FillRect" ignore alpha. Use "Composite" variants for transparency.</li>
                <li><strong>Coordinate Clipping:</strong> All drawing functions clip to buffer bounds automatically.</li>
                <li><strong>Thread Safety:</strong> Finch is not thread-safe. All drawing must occur in the rendering callback.</li>
            </ul>
        </section>

        <section class="api-section">
            <h2>See Also</h2>
            <ul>
                <li><a href="tutorial.html">Tutorial</a> - Step-by-step guide with examples</li>
                <li><a href="examples.html">Examples</a> - Complete programs demonstrating features</li>
                <li><a href="https://github.com/ranton256/finch">GitHub Repository</a> - Source code and header files</li>
            </ul>
        </section>
    </main>

    <footer>
        <p>Finch Graphics Library Â© 2025 | <a href="https://github.com/ranton256/finch">GitHub</a></p>
    </footer>
</body>
</html>
